#include <stdlib.h>
#include<stdio.h>
#include <unistd.h>
#include <sys/wait.h>

#define NUMBERS_TO_SEND 5


void fils (int tube[2]){
    close(tube[1]);

    int recu;
    for(int  i; i<NUMBERS_TO_SEND;i++){
        read(tube[0], &recu,sizeof(int));
        printf("Fils à lu l'entier %d\n",recu);
    }

    close (tube[0]);
    printf("Fils à terminé avec successful\n");
    exit(EXIT_SUCCESS);
}


int main (){

    pid_t pid_fils;
    int tube[2];

    if(pipe(tube)==-su1){
        perror("Erreur lors de la creation du pipe");
        exit(EXIT_FAILURE);
    }

    pid_fils = fork();

    if(pid_fils==-1){
        perror("Erreur lors de la creation du fils");
        exit(EXIT_FAILURE);
    }

    if(pid_fils==0){
        fils(tube);
    }else{
        close(tube[0]);
        int entiers[NUMBERS_TO_SEND]={1,2,3,4,5};

        for(int i=0; i<NUMBERS_TO_SEND; i++){
            write(tube[1],&entiers[i], sizeof(int));
            printf("Le père a ecris %d\n",entiers[i]);
        }
        close(tube[1]);

        wait(NULL);
        printf("Le père a terminer avec successful");
    }


}