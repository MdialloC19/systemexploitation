#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// Définition de la structure du maillon
typedef struct Maillon {
    char *info;                 // Information stockée dans le maillon
    struct Maillon *suivant;    // Pointeur vers le maillon suivant
    struct Maillon *precedent;  // Pointeur vers le maillon précédent
} Maillon;

Maillon *premier = NULL;    // Pointeur vers le premier maillon de la liste
Maillon *dernier = NULL;    // Pointeur vers le dernier maillon de la liste

/**
 * ajouter_devant - Ajoute un nouveau maillon contenant l'information 's' en tête de la liste
 * @s: la chaîne de caractères à ajouter
 */
void ajouter_devant(char *s) {
    // Allocation mémoire pour le nouveau maillon
    Maillon *nouveauMaillon = (Maillon*)malloc(sizeof(Maillon));
    if (nouveauMaillon == NULL) {
        fprintf(stderr, "Erreur lors de l'allocation de mémoire\n");
        exit(EXIT_FAILURE);
    }
    
    // Copie de la chaîne de caractères 's' dans le maillon
    nouveauMaillon->info = strdup(s);
    nouveauMaillon->suivant = premier;
    nouveauMaillon->precedent = NULL;

    // Mise à jour des pointeurs 'premier' et 'dernier'
    if (premier != NULL) {
        premier->precedent = nouveauMaillon;
    } else {
        dernier = nouveauMaillon; 
    }
    premier = nouveauMaillon; 
}

void ajouter_devant(Maillon **premier, Maillon **dernier, char *s) {
    Maillon *nouveauMaillon = (Maillon*)malloc(sizeof(Maillon));
    if (nouveauMaillon == NULL) {
        fprintf(stderr, "Erreur lors de l'allocation de mémoire\n");
        exit(EXIT_FAILURE);
    }
    
    nouveauMaillon->info = strdup(s);
    nouveauMaillon->suivant = *premier;
    nouveauMaillon->precedent = NULL;

    if (*premier != NULL) {
        (*premier)->precedent = nouveauMaillon;
    } else {
        *dernier = nouveauMaillon; 
    }

    *premier = nouveauMaillon; 
}

/**
 * supprimer - Supprime le maillon contenant l'information 's' de la liste
 * @s: la chaîne de caractères à supprimer
 */
void supprimer(char *s) {
    Maillon *courant = premier;

    // Parcours de la liste pour trouver le maillon à supprimer
    while (courant != NULL && strcmp(courant->info, s) != 0) {
        courant = courant->suivant;
    }

    // Vérification si le maillon a été trouvé
    if (courant == NULL) {
        printf("Le maillon avec l'information '%s' n'a pas été trouvé\n", s);
        return;
    }

    // Mise à jour des pointeurs 'premier' et 'dernier'
    if (courant == premier) {
        premier = courant->suivant;
    } else {
        courant->precedent->suivant = courant->suivant;
    }

    if (courant == dernier) {
        dernier = courant->precedent;
    } else {
        courant->suivant->precedent = courant->precedent;
    }

    // Libération de la mémoire allouée pour l'information du maillon et le maillon lui-même
    free(courant->info);
    free(courant);
}

int main() {
    // Test des fonctions
    ajouter_devant("Premier");
    ajouter_devant("Deuxième");
    ajouter_devant("Troisième");
    ajouter_devant("Quatrième");
    ajouter_devant("Cinquième");
    ajouter_devant("Sixième");
    ajouter_devant("Septième");
    ajouter_devant("Huitième");


    supprimer("Deuxième");

    // Affichage de la liste après suppression
    printf("Affichage en commencant par le premier\n");

    Maillon *courant = premier;
    while (courant != NULL) {
        printf("%s\n", courant->info);
        courant = courant->suivant;
    }
    printf("\n\n Affichage en commencant par le dernier\n");
    courant = dernier;
    while (courant != NULL) {
        printf("%s\n", courant->info);
        courant = courant->precedent;
    }
    return 0;
}
