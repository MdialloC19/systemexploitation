#include <stdio.h>
#include <stdlib.h>
#include <string.h>


// Définir la structure du maillon

struct maillon{
    char *mot;
    struct maillon *suiv;
};

typedef struct maillon MAILLON, *PTR;

/*
PTR ajoute_debut(char *mot, PTR L) qui crée un maillon pour mot, le rajoute en tête
de la liste chaînée L, et retourne la nouvelle liste.
*/ 

PTR ajoute_debut(char *mot, PTR L){

    PTR new_maillon=(PTR)malloc(sizeof(MAILLON));
    // new_maillon={
    //     char *mot =null;
    //     maillon =null
    // };
    new_maillon->mot =mot;
    new_maillon->suiv=L;

    return new_maillon;

}

/*PTR ajoute_fin(char *mot, PTR L) qui crée un maillon pour mot, le rajoute en fin de
la liste chaînée L, et retourne la nouvelle liste.*/

PTR ajoute_fin(char *mot, PTR L){

    PTR new_maillon=(PTR)malloc(sizeof(MAILLON));
    new_maillon->mot =mot;
    new_maillon->suiv=NULL;

   if(L==NULL){
    return new_maillon;
   }

  PTR last_maillon=L;

  while(last_maillon->suiv!=NULL){
    last_maillon=last_maillon->suiv;
  }
    new_maillon->suiv=NULL;
    last_maillon->suiv=new_maillon;

    return L;
}
/*
PTR supprimer(char *mot, PTR l) qui supprime le maillon qui contient le mot
considéré dans la liste L et retourne la nouvelle liste.
*/

PTR supprimer(char *mot, PTR L){

    PTR prec=NULL;
    PTR courant=L;

    while(courant!=NULL){
        if(strcmp(courant->mot,mot)==0){
            if(prec==NULL){
                L=courant->suiv;
            }else{
                prec->suiv=courant->suiv;
            }
            // free(courant->mot);
            // free(courant);
            // return L;// cela suppose qu'il n'y pas deux occurances du mot
        }
            prec=courant;
            courant=courant->suiv;
        
    }
    return L;

}

/*
void premiers( PTR liste, int n) 
 qui affiche les n premiers mots de la liste.
*/ 

void premiers( PTR liste, int n) {
    printf("Nous allons afficher les %d premiers elements\n", n);
    for(int i=0; i<n && liste!=NULL ;i++){
        printf("%s\n",liste->mot);
        liste=liste->suiv;
    }

    // taille liste 1;
    // n=2
}
/*
void purifie(MAILLON *liste) qui ne conserve dans liste qu’une seule occurrence d’un
mot représenté plusieurs fois dans la liste chaînée triée liste.
*/

void purifie(MAILLON *liste){
    MAILLON *courant=liste;

    while(courant!=NULL&&courant->suiv!=NULL){
        MAILLON  *suivant=courant->suiv;
        if(strcmp(courant->mot,suivant->mot)==0){
            courant->suiv=suivant->suiv;
            // free(suivant->mot);
            // free(suivant);
        }else{
            courant=suivant;
        }
    }    
}

int main() {
    PTR liste = NULL;

    // Test de ajoute_debut et ajoute_fin
    liste = ajoute_debut("apple", liste);
    liste = ajoute_fin("banana", liste);
    liste = ajoute_debut("apple", liste);
    liste = ajoute_fin("cherry", liste);
    liste = ajoute_fin("banana", liste);
    liste = ajoute_fin("dic2", liste);
    liste = ajoute_fin("dic1", liste);
    liste = ajoute_fin("supp", liste);
    liste = ajoute_fin("fin", liste);
    liste = ajoute_fin("fin", liste);
    liste = ajoute_fin("supp", liste);



    // Affichage de la liste
    printf("Liste initiale :\n");
    MAILLON *temp = liste;
   
    premiers(liste,10);
    printf("\n");

    // Test de supprimer
    liste = supprimer("supp", liste);
    //  premiers(liste,10)
    // Affichage après suppression
    printf("Liste après suppression supp :\n");
    premiers(liste,10);

    // temp = liste;
    // while (temp != NULL) {
    //     printf("%s ", temp->mot);
    //     temp = temp->suiv;
    // }
    printf("\n");

    // Test de premiers
    premiers(liste, 2);

    // Test de purifie
    purifie(liste);

    // Affichage après purification
    printf("Liste après purification :\n");
    // temp = liste;
    // while (temp != NULL) {
    //     printf("%s ", temp->mot);
    //     temp = temp->suiv;
    // }
     premiers(liste, 10);

    printf("\n");

    return 0;
}
