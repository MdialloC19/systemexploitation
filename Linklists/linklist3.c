#include <stdio.h>
#include <stdlib.h>

// Structure pour un monôme
typedef struct Monome {
    int coefficient;
    int exposant;
    struct Monome *suivant;
} Monome;

// Fonction pour créer un monôme
Monome* creer_monome(int coefficient, int exposant, Monome *monome) {
    Monome *nouveauMonome = (Monome*)malloc(sizeof(Monome));
    if (nouveauMonome == NULL) {
        fprintf(stderr, "Erreur lors de l'allocation de mémoire\n");
        exit(EXIT_FAILURE);
    }
    nouveauMonome->coefficient = coefficient;
    nouveauMonome->exposant = exposant;
    nouveauMonome->suivant = monome;
    return nouveauMonome;
}

Monome * ajouter_monome( int coeff, int degre,Monome *p)
{  
    Monome *mono = (Monome*) malloc(sizeof(Monome));
    if (degre=0) 
    {   
        if (mono!=NULL)
        {
            if (coeff!=0)
            {
                mono->exposant=degre;
                mono->coefficient=coeff;
                mono->suivant=NULL;
            }
        }
    }
    else mono=NULL;

    if (p==NULL) p=mono;
    else
    {
        Monome * q=p;
        while (q->suivant!=NULL) q=q->suivant;
        if (q->coefficient>degre) q->suivant=mono;
    }
    return p;
}


// Fonction DERIVEE(P) pour calculer la dérivée première d'un polynôme
Monome* DERIVEE(Monome *P) {
    Monome *derivee = NULL;
    Monome *current = P;

    while (current != NULL) {
        if (current->exposant > 0) {
            derivee = ajouter_monome(current->coefficient * current->exposant, current->exposant - 1, derivee);
        }
        current = current->suivant;
    }

    return derivee;
}

// Fonction DERIVEEKIEME(P, k) pour calculer la dérivée k-ième d'un polynôme
Monome* DERIVEEKIEME(Monome *P, int k) {
    Monome *derivee = P;

    for (int i = 0; i < k; i++) {
        derivee = DERIVEE(derivee);
    }

    return derivee;
}

int main() {
    // Exemple d'utilisation
    Monome *P = NULL;
    P = creer_monome(3, 2, P); // 3x^2
    P = creer_monome(-2, 1, P); // -2x
    P = creer_monome(5, 0, P); // 5
    printf("Polynôme P(x) = 3x^2 - 2x + 5\n");

    Monome *derivee_premiere = DERIVEE(P);
    printf("Dérivée première de P(x):\n");
    Monome *current = derivee_premiere;
    while (current != NULL) {
        printf("%dx^%d ", current->coefficient, current->exposant);
        current = current->suivant;
    }
    printf("\n");

    Monome *derivee_kieme = DERIVEEKIEME(P, 2); // Dérivée seconde
    printf("Dérivée seconde de P(x):\n");
    current = derivee_kieme;
    while (current != NULL) {
        printf("%dx^%d ", current->coefficient, current->exposant);
        current = current->suivant;
    }
}
